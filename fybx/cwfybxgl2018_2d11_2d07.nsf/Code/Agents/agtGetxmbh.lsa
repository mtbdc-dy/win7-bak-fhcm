<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE agent SYSTEM 'xmlschemas/domino_9_0.dtd'>
<agent name='agtGetxmbh' alias='通过费用类型来获取项目编号' xmlns='http://www.lotus.com/dxl'
 version='9.0' replicaid='4825833E00419143' hide='v3' publicaccess='false'
 designerversion='8.5.3' restrictions='unrestricted'>
<noteinfo noteid='188e' unid='48258072000E0C3F48258061002BB8BE' sequence='46'>
<created><datetime>20161104T155733,42+08</datetime></created>
<modified><datetime>20181107T195908,15+08</datetime></modified>
<revised><datetime>20181029T182443,79+08</datetime></revised>
<lastaccessed><datetime>20181107T195908,15+08</datetime></lastaccessed>
<addedtofile><datetime>20181107T195908,15+08</datetime></addedtofile></noteinfo>
<updatedby><name>CN=oanewadmin/O=ppm</name></updatedby>
<wassignedby><name>CN=oanewadmin/O=ppm</name></wassignedby>
<designchange><datetime>20181029T182417,31+08</datetime></designchange>
<trigger type='actionsmenu'/>
<documentset type='runonce'/><code event='options'><lotusscript>%REM
	Agent agtgetdepid
	Created 2016-11-2 by admin/ppm
	Description: Comments for Agent
%END REM
Option Public
Option Declare
Use "commonlib"


</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	On Error GoTo errorhandle
	Dim session As New NotesSession
	Dim db As NotesDatabase
	Dim view As NotesView
	Dim doc As NotesDocument
	Dim note As NotesDocument
	Set db=session.Currentdatabase
	Set doc=session.Documentcontext
	
	Dim fylx As String 
	Dim bxxm As String 
	Dim strkey As String 
	fylx=Getrefvalue(doc.Query_string_Decoded(0),"fylx=")
	bxxm=Getrefvalue(doc.Query_string_Decoded(0),"bxxm=")
	strkey=fylx+"+"+bxxm
	MsgBox "strkey==========="+strkey
	Set view=db.Getview("vwBaoxXiangmuByfyxm")
	Set note=view.Getdocumentbykey(strkey)
	Dim xmbh As String 
	If Not note Is Nothing Then
		xmbh=note.strXiangmubh(0)
	End If
	Dim jsonarry As New Converjsonobject
	Call jsonarry.Additem("xmbh", xmbh)
	MsgBox xmbh
	Print |Content-Type:text/plain;Charset=GB2312|
	Print jsonarry.Tojson()
	Exit sub
errorhandle:
	showerror("agtgetdepid")
End Sub</lotusscript></code>
<rundata processeddocs='0' exitcode='0' agentdata='601F2F9E35A60FA848258335003935EE'>
<agentmodified><datetime>20181029T182443,80+08</datetime></agentmodified>
<agentrun><datetime>20181107T174209,56+08</datetime></agentrun>
<runlog>Started running agent 'agtGetxmbh|通过费用类型来获取项目编号' on 2018-11-07 17:42:09
Ran LotusScript code
Done running agent 'agtGetxmbh|通过费用类型来获取项目编号' on 2018-11-07 17:42:09
</runlog></rundata>
<item name='$POID'><datetime>20181024T092019,95+08</datetime></item></agent>

