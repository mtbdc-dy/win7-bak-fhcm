<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE agent SYSTEM 'xmlschemas/domino_9_0.dtd'>
<agent name='agtTest' xmlns='http://www.lotus.com/dxl' version='9.0' replicaid='4825833E00419143'
 hide='v3' noreplace='true' publicaccess='false' designerversion='8.5.3' restrictions='fulladminunrestricted'
 activatable='false' enabled='false'>
<noteinfo noteid='ea2' unid='D0BA9D4B2EB3D35348258087000FA91A' sequence='101'>
<created><datetime>20161212T105103,30+08</datetime></created>
<modified><datetime>20181107T195839,39+08</datetime></modified>
<revised><datetime>20181024T101303,07+08</datetime></revised>
<lastaccessed><datetime>20181107T195839,39+08</datetime></lastaccessed>
<addedtofile><datetime>20181107T195839,39+08</datetime></addedtofile></noteinfo>
<updatedby><name>CN=oanewadmin/O=ppm</name></updatedby>
<wassignedby><name>CN=oanewadmin/O=ppm</name></wassignedby>
<designchange><datetime>20181024T101408,01+08</datetime></designchange>
<trigger type='scheduled'>
<schedule type='never' runlocation='specific' runserver='CN=oav5server1/O=ppm'/></trigger><code
 event='options'><lotusscript>%REM
	Agent agthybxflowover
	Created 2016-11-9 by admin/ppm
	Description: Comments for Agent
%END REM
Option Public
Option Declare
Use "CommonLib"

</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	On Error GoTo errhandle
	
	Dim session As New NotesSession
	Dim dbCurrent As NotesDatabase
	Dim note As NotesDocument
	Dim arr(30) As String
	Dim str2 As String
	Dim str3 As String
	Dim cwdb As NotesDatabase
	Dim vwgf As NotesView
	Dim doc As NotesDocument
	
	Set note = session.Documentcontext
	Set dbCurrent = session.Currentdatabase
	'arr(0)="dep45"
	arr(0) = "dep44"
	arr(1) = "dep31"
	arr(2) = "dep33"
	arr(3) = "dep34"
    arr(4) = "dep35"
	arr(5) = "dep37"
	arr(6) = "dep36"
	arr(7) = "dep32"
	arr(8) = "dep39"
	arr(9) = "dep46"
	arr(10) = "dep47"
	arr(11) = "dep168"
	arr(12) = "dep167"
	arr(13) = "dep165"
	arr(14) = "dep166"
	arr(15) = "dep2025"
	arr(16) = "dep2231"
	arr(17) = "dep2002"
	arr(18) = "dep161"
	arr(19) = "dep106"
	arr(20) = "dep109"
	arr(21) = "dep102"
	arr(22) = "dep101"
	arr(23) = "dep43"
	arr(24) = "dep2001"
	arr(25) = "dep41"
	arr(26) = "dep48"
	arr(27) = "dep28"
	arr(28) = "dep103"
	arr(29) = "dep164"
	arr(30) = "dep104"
	'arr(31) ="dep45"
	ForAll a In arr
		str2 = Replace(dbCurrent.Filepath,"dep7",a)
		str3 = Replace(str2,"gfcwgl","cwgl")
		Set cwdb = session.Getdatabase("", str3)
		If cwdb.Isopen Then
			Set vwgf = cwdb.Getview("vwBaoxXiangmuBytype")
			Dim vwgf1 As NotesView
			Dim docgf As NotesDocument
		    Set vwgf1=dbCurrent.Getview("vwBaoxXiangmuBytype")
		    Set docgf=vwgf1.Getfirstdocument()
			Set doc = vwgf.Getfirstdocument()
			While Not doc Is Nothing
				%rem
				If Not  docgf Is  Nothing Then
					doc.dbpath=Replace(docgf.dbpath(0),"dep7",a)
					Call doc.save(True,false)
				End If
				%end rem
				If doc.fldBaoxfylx_xm(0)="审计费" Then
					doc.strXiangmubh="660227"
					Call doc.save(True,false)
				End If
				Set doc = vwgf.Getnextdocument(doc)
			Wend
		End If
	End ForAll

	Exit sub
errhandle:
	MsgBox "agtTest has error:" + CStr(Error()) + " at line: " + CStr(Erl())
End Sub</lotusscript></code>
<rundata processeddocs='0' exitcode='0' agentdata='F3701FBF7AB962794825809F00243B74'>
<agentmodified><datetime>20170105T143523,66+08</datetime></agentmodified>
<agentrun><datetime>20180704T115842,78+08</datetime></agentrun>
<runlog>Started running agent 'agtTest' on 2018-07-04 11:57:51
Found 0 document(s) that match search criteria
Ran LotusScript code
Done running agent 'agtTest' on 2018-07-04 11:58:42
</runlog></rundata>
<item name='$POID'><datetime>20161209T150324,40+08</datetime></item></agent>

