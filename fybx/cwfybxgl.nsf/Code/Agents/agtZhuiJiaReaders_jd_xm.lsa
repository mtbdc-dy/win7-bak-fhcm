<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE agent SYSTEM 'xmlschemas/domino_9_0.dtd'>
<agent name='agtZhuiJiaReaders_jd_xm' xmlns='http://www.lotus.com/dxl' version='9.0'
 replicaid='4825807E001E75D5' hide='v3' publicaccess='false' designerversion='8.5.3'
 runonbehalfof='CN=oanewadmin/O=ppm' restrictions='fulladminunrestricted'>
<noteinfo noteid='13762' unid='03F2229C2D29E1F6482581BD00324384' sequence='8'>
<created><datetime>20171018T170900,84+08</datetime></created>
<modified><datetime>20181025T014913,66+08</datetime></modified>
<revised><datetime>20181024T092024,57+08</datetime></revised>
<lastaccessed><datetime>20181025T014913,65+08</datetime></lastaccessed>
<addedtofile><datetime>20171018T171014,24+08</datetime></addedtofile></noteinfo>
<updatedby><name>CN=oanewadmin/O=ppm</name></updatedby>
<wassignedby><name>CN=oanewadmin/O=ppm</name></wassignedby>
<designchange><datetime>20181024T092130,80+08</datetime></designchange>
<trigger type='actionsmenu'/>
<documentset type='runonce'/><code event='options'><lotusscript>%REM
	Agent agtFlagSubmitedHyys_xm
	Created 2016-12-25 by oanewadmin/ppm
	Description: Comments for Agent
%END REM
Option Public
Option Declare
Use "Commonlib"

</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	On Error GoTo errorhandle
	Dim session As New NotesSession
	Dim dbCur As NotesDatabase
	Dim agent As NotesAgent
	Dim note As NotesDocument
	Dim strUuid As String
	Dim jkvresult As Variant
	Dim jsonReader As New Jsonreader
	Dim jsonobj As New Converjsonobject
	Dim i As Integer
	Dim strjkunid As String
	Dim strhkpzunid As String
	Dim appPath As String
	Dim dbjk As NotesDatabase
	Dim dbyf As NotesDatabase
	Dim jkdoc As NotesDocument
	Dim reitem As NotesItem
	Dim hkreitem As NotesItem
	Dim hkdoc As NotesDocument
	
	Set dbCur = session.Currentdatabase
	Set agent = session.Currentagent
	
	Set note = dbCur.Getdocumentbyid(agent.Parameterdocid)
	If Not note Is Nothing Then
		'MsgBox "2222"
		appPath=StrLeftBack(note.dbPath(0),"/")
		MsgBox "note.path="+note.dbPath(0)
		appPath=StrLeftBack(appPath,"/")
		Set dbjk=session.Getdatabase("", appPath+"/jdgl_gf.nsf")
		
		strUuid = note.fldJdunid(0)
		Set jkdoc = dbjk.Getdocumentbyunid(strUuid)
		MsgBox "struuid="+strUuid
		If Not jkdoc Is Nothing Then
								
			Set reitem = jkdoc.Getfirstitem("ORIDOCUMENTREADERS")
			ForAll a In  note.DocumentAuthors
				MsgBox "a=" + CStr(a)
					Call reitem.Appendtotextlist(a)
				End ForAll
			Call jkdoc.Save(True,False)
		End If
		
	End If
	
	Exit Sub
errorhandle:
	'showError "Initialize"
	MsgBox "agtZhuiJiaReaders_xm has error: " + CStr(Error()) + " at line: " + CStr(Erl())
End Sub</lotusscript></code>
<rundata processeddocs='0' exitcode='0' agentdata='C53BB9895E43CCEE48258332002FFBEB'>
<agentmodified><datetime>20181025T014913,66+08</datetime></agentmodified>
<agentrun><datetime>20181107T195613,52+08</datetime></agentrun>
<runlog>Started running agent 'agtZhuiJiaReaders_jd_xm' on 2018-11-07 19:56:13
Ran LotusScript code
Done running agent 'agtZhuiJiaReaders_jd_xm' on 2018-11-07 19:56:13
</runlog></rundata>
<item name='$POID'><datetime>20181024T092024,57+08</datetime></item></agent>

